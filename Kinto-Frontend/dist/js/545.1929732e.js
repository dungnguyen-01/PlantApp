"use strict";(self["webpackChunk_coreui_coreui_free_vue_admin_template"]=self["webpackChunk_coreui_coreui_free_vue_admin_template"]||[]).push([[545],{2556:function(e,t,a){var i=a(6265),o=a.n(i),s=a(8);const l="https://api.kintovn.com/api/v1/organization/";class n{getAllOrganizations(){return o().get(l+"list",{headers:(0,s.Z)()})}getAllSelectByUserOrganizations(){return o().get(l+"list-user",{headers:(0,s.Z)()})}getOrganizations(e){return o().get(l+e,{headers:(0,s.Z)()})}getOrganizationById(e){return o().get(l+e,{headers:(0,s.Z)()})}createOrganization(e){return o().post(l,e,{headers:(0,s.Z)()})}updateOrganization(e,t){return o().put(l+e,t,{headers:(0,s.Z)()})}deleteOrganizationById(e){return o().get(l+"delete/"+e,{headers:(0,s.Z)()})}}t["Z"]=new n},9545:function(e,t,a){a.r(t),a.d(t,{default:function(){return O}});var i=a(3396),o=a(9242),s=a(7139);const l={class:"bg-light min-vh-100 d-flex flex-row align-items-center"},n=(0,i._)("h1",{class:"text-center"},"Login",-1),r=(0,i._)("p",{class:"text-medium-emphasis"},"Sign In to your account",-1),u={class:"text-danger"},d=(0,i.Uk)(" Login "),c=(0,i.Uk)(" Login with "),m=(0,i._)("b",null,"Google",-1),g=(0,i._)("h2",null,"Welcome!",-1),p=(0,i.Uk)(" Register Now! "),h=(0,i.Uk)("Chose organization"),f={class:"mb-5"},w=(0,i._)("label",{for:"createAt",class:"form-label text"},"Organization:",-1),_={class:"text-danger"},W=(0,i.Uk)(" Close "),C=(0,i.Uk)("Save changes");function z(e,t,a,z,k,L){const v=(0,i.up)("CIcon"),x=(0,i.up)("CInputGroupText"),y=(0,i.up)("CFormInput"),O=(0,i.up)("CInputGroup"),b=(0,i.up)("CButton"),S=(0,i.up)("CCol"),G=(0,i.up)("CRow"),$=(0,i.up)("CForm"),R=(0,i.up)("CCardBody"),Z=(0,i.up)("CCard"),I=(0,i.up)("CCardGroup"),F=(0,i.up)("CContainer"),U=(0,i.up)("CModalTitle"),V=(0,i.up)("CModalHeader"),B=(0,i.up)("v-select"),D=(0,i.up)("CModalBody"),P=(0,i.up)("CModalFooter"),T=(0,i.up)("CModal"),N=(0,i.up)("Loading");return(0,i.wg)(),(0,i.iD)(i.HY,null,[(0,i._)("div",l,[(0,i.Wm)(F,null,{default:(0,i.w5)((()=>[(0,i.Wm)(G,{class:"justify-content-center"},{default:(0,i.w5)((()=>[(0,i.Wm)(S,{md:8},{default:(0,i.w5)((()=>[(0,i.Wm)(I,null,{default:(0,i.w5)((()=>[(0,i.Wm)(Z,{class:"p-1"},{default:(0,i.w5)((()=>[(0,i.Wm)(R,null,{default:(0,i.w5)((()=>[(0,i.Wm)($,{onSubmit:(0,o.iM)(L.handleLogin,["prevent"])},{default:(0,i.w5)((()=>[n,r,(0,i._)("i",u,(0,s.zw)(k.message),1),(0,i.Wm)(O,{class:"mb-3"},{default:(0,i.w5)((()=>[(0,i.Wm)(x,null,{default:(0,i.w5)((()=>[(0,i.Wm)(v,{icon:"cil-user"})])),_:1}),(0,i.Wm)(y,{placeholder:"Email...",autocomplete:"email",modelValue:k.email,"onUpdate:modelValue":t[0]||(t[0]=e=>k.email=e),type:"email",required:""},null,8,["modelValue"])])),_:1}),(0,i.Wm)(O,null,{default:(0,i.w5)((()=>[(0,i.Wm)(x,null,{default:(0,i.w5)((()=>[(0,i.Wm)(v,{icon:"cil-lock-locked"})])),_:1}),(0,i.Wm)(y,{type:"password",placeholder:"Password",autocomplete:"current-password",modelValue:k.password,"onUpdate:modelValue":t[1]||(t[1]=e=>k.password=e),required:""},null,8,["modelValue"])])),_:1}),(0,i._)("a",{color:"link",class:"px-0 float-end",onClick:t[2]||(t[2]=e=>L.forgotPassword()),style:{cursor:"pointer"}}," Forgot password? "),(0,i.Wm)(G,{class:"mt-5"},{default:(0,i.w5)((()=>[(0,i.Wm)(S,{md:4},{default:(0,i.w5)((()=>[(0,i.Wm)(b,{color:"primary",class:"px-3 mb-2",type:"submit"},{default:(0,i.w5)((()=>[d])),_:1})])),_:1}),(0,i.Wm)(S,{md:8,class:"text-right"},{default:(0,i.w5)((()=>[(0,i.Wm)(b,{color:"warning",class:"px-3",onClick:t[3]||(t[3]=e=>L.handleLoginWithGoogle())},{default:(0,i.w5)((()=>[c,m])),_:1})])),_:1})])),_:1})])),_:1},8,["onSubmit"])])),_:1})])),_:1}),(0,i.Wm)(Z,{class:"text-white bg-primary py-5"},{default:(0,i.w5)((()=>[(0,i.Wm)(R,{class:"text-center"},{default:(0,i.w5)((()=>[(0,i._)("div",null,[g,(0,i.Wm)(b,{color:"light",variant:"outline",class:"mt-3",onClick:t[4]||(t[4]=e=>L.frmRegister())},{default:(0,i.w5)((()=>[p])),_:1})])])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})]),(0,i.Wm)(T,{ref:"my-modal",backdrop:"static",visible:k.xlDemo},{default:(0,i.w5)((()=>[(0,i.Wm)(V,null,{default:(0,i.w5)((()=>[(0,i.Wm)(U,null,{default:(0,i.w5)((()=>[h])),_:1})])),_:1}),(0,i.Wm)(D,null,{default:(0,i.w5)((()=>[(0,i._)("div",f,[w,(0,i._)("i",_,(0,s.zw)(k.messageORG),1),(0,i.Wm)(B,{modelValue:k.organizationSelected,"onUpdate:modelValue":t[5]||(t[5]=e=>k.organizationSelected=e),options:k.options,label:"name",reduce:e=>e.id},null,8,["modelValue","options","reduce"])])])),_:1}),(0,i.Wm)(P,null,{default:(0,i.w5)((()=>[(0,i.Wm)(b,{color:"secondary",onClick:t[6]||(t[6]=()=>{k.xlDemo=!1})},{default:(0,i.w5)((()=>[W])),_:1}),(0,i.Wm)(b,{color:"primary",onClick:t[7]||(t[7]=e=>L.changeORG())},{default:(0,i.w5)((()=>[C])),_:1})])),_:1})])),_:1},8,["visible"]),(0,i.Wm)(N,{active:k.isLoading,"onUpdate:active":t[8]||(t[8]=e=>k.isLoading=e)},null,8,["active"])],64)}a(7658);var k=a(7726),L=a(2556),v={name:"Login",data(){return{email:"",password:"",message:"",messageORG:"",organizationSelected:"Chose organization...",xlDemo:!1,isLoading:!1,options:[],user:{}}},methods:{handleLoginWithGoogle(){this.$gAuth.signIn().then((e=>{const t=new FormData;t.append("email",e.getBasicProfile().getEmail()),t.append("fullname",e.getBasicProfile().getName()),t.append("password",e.getBasicProfile().getId()),k.Z.loginWithGoogle(t).then((t=>{this.isLoading=!0,setTimeout((()=>{this.isLoading=!1,200==t.status?(this.user=t.data.user,"KintoVN"==t.data.user.organization.name&&"info.kintovn@gmail.com"!==t.data.user.email?(console.log(t.data.user.email),this.xlDemo=!0):t.data.accessToken&&(localStorage.setItem("user",JSON.stringify(t.data)),this.$swal.fire({title:"Login successfully!",text:`Welcome: ${e.getBasicProfile().getName()}`,icon:"success",timer:1500}),setTimeout((()=>{this.$router.push("/")}),1500))):this.$swal.fire("Failed!","Login Failed!","error")}),2e3)}))}))},handleLogin(){this.isLoading=!0,k.Z.loginWithEmail({email:this.email,password:this.password}).then((e=>{setTimeout((()=>{this.isLoading=!1,200==e.status&&(this.user=e.data.user,"KintoVN"==e.data.user.organization.name&&"info.kintovn@gmail.com"!==e.data.user.email?this.xlDemo=!0:e.data.accessToken&&(localStorage.setItem("user",JSON.stringify(e.data)),this.$swal.fire({title:"Login successfully!",text:`Welcome: ${e.data.user.fullname}`,icon:"success",timer:1500}),setTimeout((()=>{this.$router.push("/")}),1500)))}),1500)})).catch((e=>{setTimeout((()=>{this.isLoading=!1,this.$swal.fire("Failed!","Login Failed!","error"),this.message=e.response.data.error}),2e3)}))},frmRegister(){this.$router.push("/pages/register")},forgotPassword(){this.$router.push("/pages/forgot-password")},getOrganizationRepository(){L.Z.getAllOrganizations().then((e=>{this.options=e.data}))},changeORG(){if(this.xlDemo=!0,"Chose organization..."==this.organizationSelected)this.messageORG="Please select a organization";else{this.isLoading=!0;const e=new FormData;e.append("id",this.user.id),e.append("orgId",this.organizationSelected),k.Z.updateORG(e).then((e=>{this.isLoading=!1,200===e.status&&(this.xlDemo=!1,this.$swal.fire("Success!","Now go to login again!","success"),this.$router.push("/pages/login"))})).catch((e=>{this.isLoading=!1,this.$swal.fire("Failed!","Please check again!","error"),this.messageORG=e.response.this.error}))}}},created(){this.getOrganizationRepository()},watch:{organizationSelected(e,t){e!=t&&"Chose organization..."!==e&&(this.organizationSelected=e)}}},x=a(89);const y=(0,x.Z)(v,[["render",z]]);var O=y}}]);
//# sourceMappingURL=545.1929732e.js.map